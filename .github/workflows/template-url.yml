name: Run Tests (URL)

on:
  workflow_call:
    inputs:
      os:
        type: string
        default: ubuntu-latest
      command:
        required: true
        type: string

jobs:
  
  test:

    name: ${{ inputs.os }}
    runs-on: ${{ inputs.os }}
    timeout-minutes: 10
    
    strategy:
      matrix:        
        openapi_url: [
          "https://petstore3.swagger.io/api/v3/openapi.json",
          "https://petstore3.swagger.io/api/v3/openapi.yaml"
        ]
        args: [
          "--output-type OneFile",
          "--output-type OneRequestPerFile"
        ]

    steps:
    - name: 🛒 Checkout repository
      uses: actions/checkout@v3
      
    - uses: actions/setup-dotnet@v3
      with:
        dotnet-version: '8.0.x'

    - name: 🛠️ Generate code
      run: ${{ inputs.command }} "${{ matrix.openapi }}" --no-logging ${{ matrix.args }}
      working-directory: test
      shell: pwsh